# ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°è¨­è¨ˆæ›¸

**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0  
**ä½œæˆæ—¥**: 2025å¹´11æœˆ12æ—¥  
**å¯¾è±¡ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**: ãƒãƒ¼ãƒ‰ãƒœã‚¤ãƒ«ãƒ‰åˆ‘äº‹é¢¨ã‚²ãƒ¼ãƒ 

---

## ğŸ“‹ ç›®æ¬¡

1. [è¨­è¨ˆæ–¹é‡](#è¨­è¨ˆæ–¹é‡)
2. [å…±é€šé–¢æ•°ã®ä»•æ§˜](#å…±é€šé–¢æ•°ã®ä»•æ§˜)
3. [ã‚«ã‚¹ã‚¿ãƒ Hooksã®è¨­è¨ˆ](#ã‚«ã‚¹ã‚¿ãƒ hooksã®è¨­è¨ˆ)
4. [ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ä¸€è¦§](#ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ä¸€è¦§)
5. [å‹ã‚¬ãƒ¼ãƒ‰é–¢æ•°](#å‹ã‚¬ãƒ¼ãƒ‰é–¢æ•°)
6. [å®šæ•°å®šç¾©](#å®šæ•°å®šç¾©)

---

## è¨­è¨ˆæ–¹é‡

### åŸºæœ¬åŸå‰‡

1. **ç´”ç²‹é–¢æ•°ã®å„ªå…ˆ**
   - å‰¯ä½œç”¨ã‚’æŒãŸãªã„é–¢æ•°ã‚’åŸºæœ¬ã¨ã™ã‚‹
   - åŒã˜å…¥åŠ›ã«ã¯å¿…ãšåŒã˜å‡ºåŠ›ã‚’è¿”ã™
   - ãƒ†ã‚¹ãƒˆã—ã‚„ã™ã„è¨­è¨ˆ

2. **å˜ä¸€è²¬ä»»ã®åŸå‰‡**
   - 1ã¤ã®é–¢æ•°ã¯1ã¤ã®å‡¦ç†ã®ã¿ã‚’è¡Œã†
   - è¤‡é›‘ãªå‡¦ç†ã¯å°ã•ãªé–¢æ•°ã«åˆ†å‰²

3. **å‹å®‰å…¨æ€§ã®ç¢ºä¿**
   - TypeScriptã®å‹ã‚·ã‚¹ãƒ†ãƒ ã‚’æ´»ç”¨
   - å‹ã‚¬ãƒ¼ãƒ‰é–¢æ•°ã§å®Ÿè¡Œæ™‚ã®å‹ãƒã‚§ãƒƒã‚¯
   - ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ã§æŸ”è»Ÿæ€§ã‚’ç¢ºä¿

4. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**
   - äºˆæœŸã—ãªã„å…¥åŠ›ã«å¯¾ã—ã¦é©åˆ‡ã«å‡¦ç†
   - ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯æ˜ç¢ºã«

### ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
src/utils/
â”œâ”€â”€ common/           # æ±ç”¨çš„ãªå…±é€šé–¢æ•°
â”‚   â”œâ”€â”€ array.ts     # é…åˆ—æ“ä½œ
â”‚   â”œâ”€â”€ math.ts      # æ•°å€¤è¨ˆç®—
â”‚   â”œâ”€â”€ object.ts    # ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæ“ä½œ
â”‚   â””â”€â”€ string.ts    # æ–‡å­—åˆ—æ“ä½œ
â”œâ”€â”€ game/            # ã‚²ãƒ¼ãƒ å›ºæœ‰ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â”œâ”€â”€ position.ts  # åº§æ¨™è¨ˆç®—
â”‚   â”œâ”€â”€ grid.ts      # ã‚°ãƒªãƒƒãƒ‰æ“ä½œ
â”‚   â”œâ”€â”€ damage.ts    # ãƒ€ãƒ¡ãƒ¼ã‚¸è¨ˆç®—
â”‚   â”œâ”€â”€ reward.ts    # å ±é…¬è¨ˆç®—
â”‚   â””â”€â”€ validation.ts # ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
â”œâ”€â”€ hooks/           # ã‚«ã‚¹ã‚¿ãƒ Hooks
â”‚   â”œâ”€â”€ useBattle.ts
â”‚   â”œâ”€â”€ useUnitPlacement.ts
â”‚   â”œâ”€â”€ useAnimation.ts
â”‚   â”œâ”€â”€ useKeyboard.ts
â”‚   â””â”€â”€ useLocalStorage.ts
â””â”€â”€ constants/       # å®šæ•°å®šç¾©
    â”œâ”€â”€ game.ts
    â”œâ”€â”€ ui.ts
    â””â”€â”€ animation.ts
```

---

## å…±é€šé–¢æ•°ã®ä»•æ§˜

### åº§æ¨™è¨ˆç®—é–¢æ•° (position.ts)

#### isPositionEqual
```typescript
/**
 * 2ã¤ã®åº§æ¨™ãŒç­‰ã—ã„ã‹åˆ¤å®š
 * @param pos1 - åº§æ¨™1
 * @param pos2 - åº§æ¨™2
 * @returns boolean - ç­‰ã—ã‘ã‚Œã°true
 */
export function isPositionEqual(pos1: Position, pos2: Position): boolean
```

**å®Ÿè£…**:
```typescript
export function isPositionEqual(pos1: Position, pos2: Position): boolean {
  return pos1.x === pos2.x && pos1.y === pos2.y
}
```

---

#### isPositionInBounds
```typescript
/**
 * åº§æ¨™ãŒã‚°ãƒªãƒƒãƒ‰ç¯„å›²å†…ã‹ãƒã‚§ãƒƒã‚¯
 * @param position - ãƒã‚§ãƒƒã‚¯ã™ã‚‹åº§æ¨™
 * @param gridSize - ã‚°ãƒªãƒƒãƒ‰ã‚µã‚¤ã‚º
 * @returns boolean - ç¯„å›²å†…ãªã‚‰true
 */
export function isPositionInBounds(position: Position, gridSize: GridSize): boolean
```

**å®Ÿè£…**:
```typescript
export function isPositionInBounds(position: Position, gridSize: GridSize): boolean {
  return (
    position.x >= 0 &&
    position.x < gridSize.width &&
    position.y >= 0 &&
    position.y < gridSize.height
  )
}
```

---

#### getAdjacentPositions
```typescript
/**
 * æŒ‡å®šåº§æ¨™ã®éš£æ¥åº§æ¨™ã‚’å–å¾—ï¼ˆä¸Šä¸‹å·¦å³ï¼‰
 * @param position - åŸºæº–åº§æ¨™
 * @param gridSize - ã‚°ãƒªãƒƒãƒ‰ã‚µã‚¤ã‚º
 * @returns Position[] - éš£æ¥åº§æ¨™ã®é…åˆ—ï¼ˆç¯„å›²å¤–ã¯é™¤å¤–ï¼‰
 */
export function getAdjacentPositions(position: Position, gridSize: GridSize): Position[]
```

**å®Ÿè£…**:
```typescript
export function getAdjacentPositions(position: Position, gridSize: GridSize): Position[] {
  const directions = [
    { x: 0, y: -1 },  // ä¸Š
    { x: 1, y: 0 },   // å³
    { x: 0, y: 1 },   // ä¸‹
    { x: -1, y: 0 }   // å·¦
  ]
  
  return directions
    .map(dir => ({ x: position.x + dir.x, y: position.y + dir.y }))
    .filter(pos => isPositionInBounds(pos, gridSize))
}
```

---

#### getDistanceBetween
```typescript
/**
 * 2ã¤ã®åº§æ¨™é–“ã®ãƒãƒ³ãƒãƒƒã‚¿ãƒ³è·é›¢ã‚’è¨ˆç®—
 * @param pos1 - åº§æ¨™1
 * @param pos2 - åº§æ¨™2
 * @returns number - ãƒãƒ³ãƒãƒƒã‚¿ãƒ³è·é›¢
 */
export function getDistanceBetween(pos1: Position, pos2: Position): number
```

**å®Ÿè£…**:
```typescript
export function getDistanceBetween(pos1: Position, pos2: Position): number {
  return Math.abs(pos1.x - pos2.x) + Math.abs(pos1.y - pos2.y)
}
```

---

#### rotatePosition
```typescript
/**
 * åº§æ¨™ã‚’æŒ‡å®šè§’åº¦å›è»¢ã•ã›ã‚‹ï¼ˆéƒ¨éšŠé…ç½®ç”¨ï¼‰
 * @param position - å…ƒã®åº§æ¨™ï¼ˆå·¦ä¸Šã‚’åŸç‚¹ã¨ã—ãŸç›¸å¯¾åº§æ¨™ï¼‰
 * @param rotation - å›è»¢è§’åº¦
 * @param unitSize - éƒ¨éšŠã®åŸºæº–ã‚µã‚¤ã‚ºï¼ˆå›è»¢ã®ä¸­å¿ƒè¨ˆç®—ç”¨ï¼‰
 * @returns Position - å›è»¢å¾Œã®åº§æ¨™
 */
export function rotatePosition(
  position: Position,
  rotation: Rotation,
  unitSize: { width: number; height: number }
): Position
```

**å®Ÿè£…**:
```typescript
export function rotatePosition(
  position: Position,
  rotation: Rotation,
  unitSize: { width: number; height: number }
): Position {
  const { x, y } = position
  
  switch (rotation) {
    case Rotation.DEG_0:
      return { x, y }
    case Rotation.DEG_90:
      return { x: unitSize.height - 1 - y, y: x }
    case Rotation.DEG_180:
      return { x: unitSize.width - 1 - x, y: unitSize.height - 1 - y }
    case Rotation.DEG_270:
      return { x: y, y: unitSize.width - 1 - x }
    default:
      return { x, y }
  }
}
```

---

### ã‚°ãƒªãƒƒãƒ‰æ“ä½œé–¢æ•° (grid.ts)

#### createEmptyGrid
```typescript
/**
 * ç©ºã®ã‚°ãƒªãƒƒãƒ‰ã‚’ç”Ÿæˆ
 * @param size - ã‚°ãƒªãƒƒãƒ‰ã‚µã‚¤ã‚º
 * @returns Cell[][] - åˆæœŸåŒ–ã•ã‚ŒãŸã‚°ãƒªãƒƒãƒ‰
 */
export function createEmptyGrid(size: GridSize): Cell[][]
```

**å®Ÿè£…**:
```typescript
export function createEmptyGrid(size: GridSize): Cell[][] {
  const grid: Cell[][] = []
  
  for (let y = 0; y < size.height; y++) {
    const row: Cell[] = []
    for (let x = 0; x < size.width; x++) {
      row.push({
        position: { x, y },
        state: CellState.UNEXPLORED,
        isRevealed: false
      })
    }
    grid.push(row)
  }
  
  return grid
}
```

---

#### getCellAt
```typescript
/**
 * æŒ‡å®šåº§æ¨™ã®ã‚»ãƒ«ã‚’å–å¾—
 * @param grid - ã‚°ãƒªãƒƒãƒ‰
 * @param position - åº§æ¨™
 * @returns Cell | null - ã‚»ãƒ«ï¼ˆç¯„å›²å¤–ãªã‚‰nullï¼‰
 */
export function getCellAt(grid: Cell[][], position: Position): Cell | null
```

**å®Ÿè£…**:
```typescript
export function getCellAt(grid: Cell[][], position: Position): Cell | null {
  if (position.y < 0 || position.y >= grid.length) return null
  if (position.x < 0 || position.x >= grid[0].length) return null
  
  return grid[position.y][position.x]
}
```

---

#### getUnitOccupiedCells
```typescript
/**
 * éƒ¨éšŠãŒå æœ‰ã™ã‚‹ã‚»ãƒ«ã®åº§æ¨™ãƒªã‚¹ãƒˆã‚’å–å¾—
 * @param unit - éƒ¨éšŠãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿
 * @param basePosition - é…ç½®ä½ç½®ï¼ˆå·¦ä¸Šï¼‰
 * @param rotation - å›è»¢è§’åº¦
 * @returns Position[] - å æœ‰ã‚»ãƒ«ã®åº§æ¨™ãƒªã‚¹ãƒˆ
 */
export function getUnitOccupiedCells(
  unit: Unit,
  basePosition: Position,
  rotation: Rotation
): Position[]
```

**å®Ÿè£…**:
```typescript
export function getUnitOccupiedCells(
  unit: Unit,
  basePosition: Position,
  rotation: Rotation
): Position[] {
  const cells: Position[] = []
  const shape = unit.shape
  
  // shapeã®å„ã‚»ãƒ«ã‚’ãƒã‚§ãƒƒã‚¯
  for (let y = 0; y < shape.length; y++) {
    for (let x = 0; x < shape[y].length; x++) {
      if (shape[y][x] === 1) {
        // å›è»¢ã‚’é©ç”¨
        const rotated = rotatePosition(
          { x, y },
          rotation,
          { width: shape[0].length, height: shape.length }
        )
        
        cells.push({
          x: basePosition.x + rotated.x,
          y: basePosition.y + rotated.y
        })
      }
    }
  }
  
  return cells
}
```

---

#### canPlaceUnit
```typescript
/**
 * æŒ‡å®šä½ç½®ã«éƒ¨éšŠã‚’é…ç½®ã§ãã‚‹ã‹ãƒã‚§ãƒƒã‚¯
 * @param unit - éƒ¨éšŠãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿
 * @param basePosition - é…ç½®ä½ç½®
 * @param rotation - å›è»¢è§’åº¦
 * @param field - ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
 * @returns boolean - é…ç½®å¯èƒ½ãªã‚‰true
 */
export function canPlaceUnit(
  unit: Unit,
  basePosition: Position,
  rotation: Rotation,
  field: Field
): boolean
```

**å®Ÿè£…**:
```typescript
export function canPlaceUnit(
  unit: Unit,
  basePosition: Position,
  rotation: Rotation,
  field: Field
): boolean {
  const occupiedCells = getUnitOccupiedCells(unit, basePosition, rotation)
  
  // ã™ã¹ã¦ã®ã‚»ãƒ«ãŒç¯„å›²å†…ã‹ç¢ºèª
  for (const cell of occupiedCells) {
    if (!isPositionInBounds(cell, field.size)) {
      return false
    }
    
    // æ—¢ã«ä»–ã®éƒ¨éšŠãŒé…ç½®ã•ã‚Œã¦ã„ãªã„ã‹ç¢ºèª
    const gridCell = getCellAt(field.cells, cell)
    if (gridCell?.unitId) {
      return false
    }
  }
  
  return true
}
```

---

### é…åˆ—æ“ä½œé–¢æ•° (array.ts)

#### randomChoice
```typescript
/**
 * é…åˆ—ã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«è¦ç´ ã‚’é¸æŠ
 * @param array - å¯¾è±¡é…åˆ—
 * @returns T | undefined - é¸æŠã•ã‚ŒãŸè¦ç´ ï¼ˆç©ºé…åˆ—ãªã‚‰undefinedï¼‰
 */
export function randomChoice<T>(array: T[]): T | undefined
```

**å®Ÿè£…**:
```typescript
export function randomChoice<T>(array: T[]): T | undefined {
  if (array.length === 0) return undefined
  return array[Math.floor(Math.random() * array.length)]
}
```

---

#### shuffle
```typescript
/**
 * é…åˆ—ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«ï¼ˆFisher-Yatesã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼‰
 * @param array - å¯¾è±¡é…åˆ—
 * @returns T[] - ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã•ã‚ŒãŸæ–°ã—ã„é…åˆ—
 */
export function shuffle<T>(array: T[]): T[]
```

**å®Ÿè£…**:
```typescript
export function shuffle<T>(array: T[]): T[] {
  const result = [...array]
  
  for (let i = result.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1))
    ;[result[i], result[j]] = [result[j], result[i]]
  }
  
  return result
}
```

---

#### chunk
```typescript
/**
 * é…åˆ—ã‚’æŒ‡å®šã‚µã‚¤ã‚ºã®ãƒãƒ£ãƒ³ã‚¯ã«åˆ†å‰²
 * @param array - å¯¾è±¡é…åˆ—
 * @param size - ãƒãƒ£ãƒ³ã‚¯ã‚µã‚¤ã‚º
 * @returns T[][] - åˆ†å‰²ã•ã‚ŒãŸé…åˆ—
 */
export function chunk<T>(array: T[], size: number): T[][]
```

**å®Ÿè£…**:
```typescript
export function chunk<T>(array: T[], size: number): T[][] {
  const result: T[][] = []
  
  for (let i = 0; i < array.length; i += size) {
    result.push(array.slice(i, i + size))
  }
  
  return result
}
```

---

#### unique
```typescript
/**
 * é…åˆ—ã‹ã‚‰é‡è¤‡ã‚’é™¤å»
 * @param array - å¯¾è±¡é…åˆ—
 * @param keyFn - ã‚­ãƒ¼æŠ½å‡ºé–¢æ•°ï¼ˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆé…åˆ—ã®å ´åˆï¼‰
 * @returns T[] - é‡è¤‡ãªã—ã®é…åˆ—
 */
export function unique<T>(array: T[], keyFn?: (item: T) => any): T[]
```

**å®Ÿè£…**:
```typescript
export function unique<T>(array: T[], keyFn?: (item: T) => any): T[] {
  if (!keyFn) {
    return Array.from(new Set(array))
  }
  
  const seen = new Set()
  return array.filter(item => {
    const key = keyFn(item)
    if (seen.has(key)) {
      return false
    }
    seen.add(key)
    return true
  })
}
```

---

### æ•°å€¤è¨ˆç®—é–¢æ•° (math.ts)

#### clamp
```typescript
/**
 * å€¤ã‚’æŒ‡å®šç¯„å›²å†…ã«åã‚ã‚‹
 * @param value - å¯¾è±¡å€¤
 * @param min - æœ€å°å€¤
 * @param max - æœ€å¤§å€¤
 * @returns number - ç¯„å›²å†…ã«åã‚ã‚‰ã‚ŒãŸå€¤
 */
export function clamp(value: number, min: number, max: number): number
```

**å®Ÿè£…**:
```typescript
export function clamp(value: number, min: number, max: number): number {
  return Math.max(min, Math.min(max, value))
}
```

---

#### isInRange
```typescript
/**
 * å€¤ãŒç¯„å›²å†…ã‹ãƒã‚§ãƒƒã‚¯
 * @param value - ãƒã‚§ãƒƒã‚¯ã™ã‚‹å€¤
 * @param min - æœ€å°å€¤
 * @param max - æœ€å¤§å€¤
 * @returns boolean - ç¯„å›²å†…ãªã‚‰true
 */
export function isInRange(value: number, min: number, max: number): boolean
```

**å®Ÿè£…**:
```typescript
export function isInRange(value: number, min: number, max: number): boolean {
  return value >= min && value <= max
}
```

---

#### randomInt
```typescript
/**
 * æŒ‡å®šç¯„å›²ã®ãƒ©ãƒ³ãƒ€ãƒ ãªæ•´æ•°ã‚’ç”Ÿæˆ
 * @param min - æœ€å°å€¤ï¼ˆå«ã‚€ï¼‰
 * @param max - æœ€å¤§å€¤ï¼ˆå«ã‚€ï¼‰
 * @returns number - ãƒ©ãƒ³ãƒ€ãƒ ãªæ•´æ•°
 */
export function randomInt(min: number, max: number): number
```

**å®Ÿè£…**:
```typescript
export function randomInt(min: number, max: number): number {
  return Math.floor(Math.random() * (max - min + 1)) + min
}
```

---

#### percentage
```typescript
/**
 * ãƒ‘ãƒ¼ã‚»ãƒ³ãƒ†ãƒ¼ã‚¸ã‚’è¨ˆç®—
 * @param value - ç¾åœ¨å€¤
 * @param max - æœ€å¤§å€¤
 * @returns number - ãƒ‘ãƒ¼ã‚»ãƒ³ãƒ†ãƒ¼ã‚¸ï¼ˆ0-100ï¼‰
 */
export function percentage(value: number, max: number): number
```

**å®Ÿè£…**:
```typescript
export function percentage(value: number, max: number): number {
  if (max === 0) return 0
  return Math.round((value / max) * 100)
}
```

---

### ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæ“ä½œé–¢æ•° (object.ts)

#### deepCopy
```typescript
/**
 * ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ‡ã‚£ãƒ¼ãƒ—ã‚³ãƒ”ãƒ¼
 * @param obj - ã‚³ãƒ”ãƒ¼å…ƒã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
 * @returns T - ã‚³ãƒ”ãƒ¼ã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
 */
export function deepCopy<T>(obj: T): T
```

**å®Ÿè£…**:
```typescript
export function deepCopy<T>(obj: T): T {
  return JSON.parse(JSON.stringify(obj))
}
```

**æ³¨æ„**: é–¢æ•°ã‚„Dateã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯æ­£ã—ãã‚³ãƒ”ãƒ¼ã•ã‚Œã¾ã›ã‚“ã€‚ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ‡ãƒ¼ã‚¿æ§‹é€ ã«ã®ã¿ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚

---

#### omit
```typescript
/**
 * ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰æŒ‡å®šã‚­ãƒ¼ã‚’é™¤å¤–
 * @param obj - å…ƒã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
 * @param keys - é™¤å¤–ã™ã‚‹ã‚­ãƒ¼ã®é…åˆ—
 * @returns Partial<T> - é™¤å¤–å¾Œã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
 */
export function omit<T extends object, K extends keyof T>(
  obj: T,
  keys: K[]
): Omit<T, K>
```

**å®Ÿè£…**:
```typescript
export function omit<T extends object, K extends keyof T>(
  obj: T,
  keys: K[]
): Omit<T, K> {
  const result = { ...obj }
  keys.forEach(key => delete result[key])
  return result
}
```

---

#### pick
```typescript
/**
 * ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰æŒ‡å®šã‚­ãƒ¼ã®ã¿ã‚’æŠ½å‡º
 * @param obj - å…ƒã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
 * @param keys - æŠ½å‡ºã™ã‚‹ã‚­ãƒ¼ã®é…åˆ—
 * @returns Pick<T, K> - æŠ½å‡ºå¾Œã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
 */
export function pick<T extends object, K extends keyof T>(
  obj: T,
  keys: K[]
): Pick<T, K>
```

**å®Ÿè£…**:
```typescript
export function pick<T extends object, K extends keyof T>(
  obj: T,
  keys: K[]
): Pick<T, K> {
  const result = {} as Pick<T, K>
  keys.forEach(key => {
    if (key in obj) {
      result[key] = obj[key]
    }
  })
  return result
}
```

---

### æ–‡å­—åˆ—æ“ä½œé–¢æ•° (string.ts)

#### formatNumber
```typescript
/**
 * æ•°å€¤ã‚’3æ¡åŒºåˆ‡ã‚Šã§ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
 * @param num - æ•°å€¤
 * @returns string - ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã•ã‚ŒãŸæ–‡å­—åˆ—
 */
export function formatNumber(num: number): string
```

**å®Ÿè£…**:
```typescript
export function formatNumber(num: number): string {
  return num.toLocaleString('ja-JP')
}
```

---

#### formatCurrency
```typescript
/**
 * æ•°å€¤ã‚’é€šè²¨å½¢å¼ã§ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
 * @param amount - é‡‘é¡
 * @returns string - ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã•ã‚ŒãŸæ–‡å­—åˆ—ï¼ˆä¾‹: "Â¥1,000"ï¼‰
 */
export function formatCurrency(amount: number): string
```

**å®Ÿè£…**:
```typescript
export function formatCurrency(amount: number): string {
  return `Â¥${formatNumber(amount)}`
}
```

---

#### truncate
```typescript
/**
 * æ–‡å­—åˆ—ã‚’æŒ‡å®šé•·ã§åˆ‡ã‚Šè©°ã‚ã‚‹
 * @param str - å…ƒã®æ–‡å­—åˆ—
 * @param maxLength - æœ€å¤§é•·
 * @param suffix - çœç•¥è¨˜å·ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: '...'ï¼‰
 * @returns string - åˆ‡ã‚Šè©°ã‚ã‚‰ã‚ŒãŸæ–‡å­—åˆ—
 */
export function truncate(str: string, maxLength: number, suffix = '...'): string
```

**å®Ÿè£…**:
```typescript
export function truncate(str: string, maxLength: number, suffix = '...'): string {
  if (str.length <= maxLength) return str
  return str.slice(0, maxLength - suffix.length) + suffix
}
```

---

### ã‚²ãƒ¼ãƒ å›ºæœ‰ã®è¨ˆç®—é–¢æ•° (damage.ts / reward.ts)

#### calculateDamage
```typescript
/**
 * ãƒ€ãƒ¡ãƒ¼ã‚¸ã‚’è¨ˆç®—
 * @param attacker - æ”»æ’ƒå´ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
 * @param defender - é˜²å¾¡å´ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
 * @returns number - ãƒ€ãƒ¡ãƒ¼ã‚¸é‡
 */
export function calculateDamage(
  attacker: { AT: number },
  defender: { DF: number }
): number
```

**å®Ÿè£…è©³ç´°**: 03_ã‚²ãƒ¼ãƒ ãƒ­ã‚¸ãƒƒã‚¯è¨­è¨ˆæ›¸.md ã‚’å‚ç…§

---

#### calculateLevelUpCost
```typescript
/**
 * ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ã‚³ã‚¹ãƒˆã‚’è¨ˆç®—
 * @param stat - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚¿ã‚¤ãƒ—
 * @param currentLevel - ç¾åœ¨ã®ãƒ¬ãƒ™ãƒ«
 * @returns number - ã‚³ã‚¹ãƒˆ
 */
export function calculateLevelUpCost(stat: StatType, currentLevel: number): number
```

**å®Ÿè£…è©³ç´°**: 03_ã‚²ãƒ¼ãƒ ãƒ­ã‚¸ãƒƒã‚¯è¨­è¨ˆæ›¸.md ã‚’å‚ç…§

---

#### calculateReward
```typescript
/**
 * æˆ¦é—˜å ±é…¬ã‚’è¨ˆç®—
 * @param result - æˆ¦é—˜çµæœ
 * @param enemy - æ•µãƒ‡ãƒ¼ã‚¿
 * @returns BattleResult - æ›´æ–°ã•ã‚ŒãŸæˆ¦é—˜çµæœ
 */
export function calculateReward(
  result: Partial<BattleResult>,
  enemy: Enemy
): BattleResult
```

**å®Ÿè£…è©³ç´°**: 03_ã‚²ãƒ¼ãƒ ãƒ­ã‚¸ãƒƒã‚¯è¨­è¨ˆæ›¸.md ã‚’å‚ç…§

---

### ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³é–¢æ•° (validation.ts)

#### isValidGridPosition
```typescript
/**
 * ã‚°ãƒªãƒƒãƒ‰åº§æ¨™ã®å¦¥å½“æ€§ã‚’ãƒã‚§ãƒƒã‚¯
 * @param position - ãƒã‚§ãƒƒã‚¯ã™ã‚‹åº§æ¨™
 * @param gridSize - ã‚°ãƒªãƒƒãƒ‰ã‚µã‚¤ã‚º
 * @returns boolean - å¦¥å½“ãªã‚‰true
 */
export function isValidGridPosition(position: Position, gridSize: GridSize): boolean
```

**å®Ÿè£…**:
```typescript
export function isValidGridPosition(position: Position, gridSize: GridSize): boolean {
  return isPositionInBounds(position, gridSize)
}
```

---

#### isValidRotation
```typescript
/**
 * å›è»¢è§’åº¦ã®å¦¥å½“æ€§ã‚’ãƒã‚§ãƒƒã‚¯
 * @param rotation - ãƒã‚§ãƒƒã‚¯ã™ã‚‹è§’åº¦
 * @returns boolean - å¦¥å½“ãªã‚‰true
 */
export function isValidRotation(rotation: number): boolean
```

**å®Ÿè£…**:
```typescript
export function isValidRotation(rotation: number): boolean {
  return [0, 90, 180, 270].includes(rotation)
}
```

---

#### canAffordItem
```typescript
/**
 * ã‚¢ã‚¤ãƒ†ãƒ ã‚’è³¼å…¥ã§ãã‚‹ã‹ãƒã‚§ãƒƒã‚¯
 * @param playerMoney - ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®æ‰€æŒé‡‘
 * @param itemCost - ã‚¢ã‚¤ãƒ†ãƒ ã®ä¾¡æ ¼
 * @returns boolean - è³¼å…¥å¯èƒ½ãªã‚‰true
 */
export function canAffordItem(playerMoney: number, itemCost: number): boolean
```

**å®Ÿè£…**:
```typescript
export function canAffordItem(playerMoney: number, itemCost: number): boolean {
  return playerMoney >= itemCost && itemCost >= 0
}
```

---

## ã‚«ã‚¹ã‚¿ãƒ Hooksã®è¨­è¨ˆ

### useBattle

æˆ¦é—˜ãƒ­ã‚¸ãƒƒã‚¯ã‚’ã‚«ãƒ—ã‚»ãƒ«åŒ–ã™ã‚‹Hook

**ãƒ•ã‚¡ã‚¤ãƒ«**: `src/utils/hooks/useBattle.ts`

**è²¬å‹™**:
- æ”»æ’ƒå‡¦ç†ã®å®Ÿè¡Œ
- ç‰¹æ®Šæ”»æ’ƒã®å®Ÿè¡Œ
- ã‚¿ãƒ¼ãƒ³ç®¡ç†
- å‹æ•—åˆ¤å®šã®ç›£è¦–
- ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³çŠ¶æ…‹ã®ç®¡ç†

**ä½¿ç”¨ä¾‹**:
```typescript
const {
  attack,
  useSpecialAttack,
  canAttack,
  isPlayerTurn,
  winner,
  isAnimating
} = useBattle()
```

**æˆ»ã‚Šå€¤ã®å‹**:
```typescript
interface UseBattleReturn {
  attack: (position: Position) => void
  useSpecialAttack: (unitId: string, position: Position) => void
  canAttack: boolean
  isPlayerTurn: boolean
  winner: 'player' | 'enemy' | null
  isAnimating: boolean
}
```

**å®Ÿè£…ãƒã‚¤ãƒ³ãƒˆ**:
```typescript
export function useBattle(): UseBattleReturn {
  const battleStore = useBattleStore()
  
  // æ”»æ’ƒå‡¦ç†
  const attack = useCallback((position: Position) => {
    if (!canAttack) return
    
    const result = battleStore.attack(position)
    
    // å‹æ•—åˆ¤å®š
    const winner = battleStore.checkVictory()
    if (winner) {
      battleStore.endBattle(winner)
    }
  }, [battleStore, canAttack])
  
  // ç‰¹æ®Šæ”»æ’ƒå‡¦ç†
  const useSpecialAttack = useCallback((unitId: string, position: Position) => {
    if (!canAttack) return
    
    battleStore.executeSpecialAttack(unitId, position)
    
    const winner = battleStore.checkVictory()
    if (winner) {
      battleStore.endBattle(winner)
    }
  }, [battleStore, canAttack])
  
  const canAttack = useMemo(() => {
    return (
      battleStore.turn === Turn.PLAYER &&
      !battleStore.isAnimating &&
      battleStore.phase === BattlePhase.BATTLE
    )
  }, [battleStore.turn, battleStore.isAnimating, battleStore.phase])
  
  return {
    attack,
    useSpecialAttack,
    canAttack,
    isPlayerTurn: battleStore.turn === Turn.PLAYER,
    winner: battleStore.checkVictory(),
    isAnimating: battleStore.isAnimating
  }
}
```

---

### useUnitPlacement

éƒ¨éšŠé…ç½®ãƒ­ã‚¸ãƒƒã‚¯ã‚’ã‚«ãƒ—ã‚»ãƒ«åŒ–ã™ã‚‹Hook

**ãƒ•ã‚¡ã‚¤ãƒ«**: `src/utils/hooks/useUnitPlacement.ts`

**è²¬å‹™**:
- éƒ¨éšŠã®é¸æŠãƒ»è§£é™¤
- éƒ¨éšŠã®å›è»¢
- é…ç½®å¯èƒ½æ€§ãƒã‚§ãƒƒã‚¯
- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤ºç”¨ã®ã‚»ãƒ«åº§æ¨™è¨ˆç®—

**ä½¿ç”¨ä¾‹**:
```typescript
const {
  selectedUnit,
  rotation,
  previewCells,
  selectUnit,
  rotate,
  placeUnit,
  canPlace
} = useUnitPlacement()
```

**æˆ»ã‚Šå€¤ã®å‹**:
```typescript
interface UseUnitPlacementReturn {
  selectedUnit: Unit | null
  rotation: Rotation
  previewCells: Position[]
  selectUnit: (unitId: string) => void
  rotate: () => void
  placeUnit: (position: Position) => boolean
  canPlace: (position: Position) => boolean
}
```

**å®Ÿè£…ãƒã‚¤ãƒ³ãƒˆ**:
```typescript
export function useUnitPlacement(): UseUnitPlacementReturn {
  const playerStore = usePlayerStore()
  const [selectedUnitId, setSelectedUnitId] = useState<string | null>(null)
  const [rotation, setRotation] = useState<Rotation>(Rotation.DEG_0)
  
  // é¸æŠä¸­ã®éƒ¨éšŠãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
  const selectedUnit = useMemo(() => {
    if (!selectedUnitId) return null
    return UNITS.find(u => u.id === selectedUnitId) || null
  }, [selectedUnitId])
  
  // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”¨ã®ã‚»ãƒ«åº§æ¨™
  const previewCells = useMemo(() => {
    if (!selectedUnit) return []
    // ä»®ã®ä½ç½®(0,0)ã§ã®å æœ‰ã‚»ãƒ«ã‚’è¨ˆç®—
    return getUnitOccupiedCells(selectedUnit, { x: 0, y: 0 }, rotation)
  }, [selectedUnit, rotation])
  
  // éƒ¨éšŠé¸æŠ
  const selectUnit = useCallback((unitId: string) => {
    setSelectedUnitId(unitId)
    setRotation(Rotation.DEG_0)
  }, [])
  
  // å›è»¢
  const rotate = useCallback(() => {
    setRotation(prev => {
      switch (prev) {
        case Rotation.DEG_0: return Rotation.DEG_90
        case Rotation.DEG_90: return Rotation.DEG_180
        case Rotation.DEG_180: return Rotation.DEG_270
        case Rotation.DEG_270: return Rotation.DEG_0
        default: return Rotation.DEG_0
      }
    })
  }, [])
  
  // é…ç½®å¯èƒ½ã‹ãƒã‚§ãƒƒã‚¯
  const canPlace = useCallback((position: Position) => {
    if (!selectedUnit) return false
    return canPlaceUnit(selectedUnit, position, rotation, playerStore.field)
  }, [selectedUnit, rotation, playerStore.field])
  
  // éƒ¨éšŠã‚’é…ç½®
  const placeUnit = useCallback((position: Position) => {
    if (!selectedUnit || !canPlace(position)) return false
    
    const success = playerStore.placeUnit(selectedUnitId!, position, rotation)
    
    if (success) {
      setSelectedUnitId(null)
      setRotation(Rotation.DEG_0)
    }
    
    return success
  }, [selectedUnit, selectedUnitId, rotation, canPlace, playerStore])
  
  return {
    selectedUnit,
    rotation,
    previewCells,
    selectUnit,
    rotate,
    placeUnit,
    canPlace
  }
}
```

---

### useAnimation

ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ç®¡ç†ã‚’ã‚«ãƒ—ã‚»ãƒ«åŒ–ã™ã‚‹Hook

**ãƒ•ã‚¡ã‚¤ãƒ«**: `src/utils/hooks/useAnimation.ts`

**è²¬å‹™**:
- ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®è¡¨ç¤ºãƒ»éè¡¨ç¤ºåˆ¶å¾¡
- ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®Œäº†ã®æ¤œçŸ¥
- ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚­ãƒ¥ãƒ¼ã®ç®¡ç†

**ä½¿ç”¨ä¾‹**:
```typescript
const {
  showEffect,
  currentEffect,
  isAnimating
} = useAnimation()
```

**æˆ»ã‚Šå€¤ã®å‹**:
```typescript
interface UseAnimationReturn {
  showEffect: (type: EffectType, position: Position, duration?: number) => void
  currentEffect: AnimationState | null
  isAnimating: boolean
}

interface AnimationState {
  type: EffectType
  position: Position
  id: string
}

type EffectType = 'hit' | 'miss' | 'destroy' | 'heal' | 'special'
```

**å®Ÿè£…ãƒã‚¤ãƒ³ãƒˆ**:
```typescript
export function useAnimation(): UseAnimationReturn {
  const [effects, setEffects] = useState<AnimationState[]>([])
  
  // ã‚¨ãƒ•ã‚§ã‚¯ãƒˆè¡¨ç¤º
  const showEffect = useCallback((
    type: EffectType,
    position: Position,
    duration = 500
  ) => {
    const id = `${type}-${position.x}-${position.y}-${Date.now()}`
    
    setEffects(prev => [...prev, { type, position, id }])
    
    // æŒ‡å®šæ™‚é–“å¾Œã«è‡ªå‹•å‰Šé™¤
    setTimeout(() => {
      setEffects(prev => prev.filter(e => e.id !== id))
    }, duration)
  }, [])
  
  return {
    showEffect,
    currentEffect: effects[0] || null,
    isAnimating: effects.length > 0
  }
}
```

---

### useKeyboard

ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ“ä½œã‚’ç®¡ç†ã™ã‚‹Hook

**ãƒ•ã‚¡ã‚¤ãƒ«**: `src/utils/hooks/useKeyboard.ts`

**è²¬å‹™**:
- ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚¤ãƒ™ãƒ³ãƒˆã®ç›£è¦–
- ã‚­ãƒ¼æŠ¼ä¸‹æ™‚ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯å®Ÿè¡Œ

**ä½¿ç”¨ä¾‹**:
```typescript
useKeyboard({
  'Escape': () => closeModal(),
  'Enter': () => confirmAction(),
  'ArrowUp': () => moveUp(),
  'ArrowDown': () => moveDown()
})
```

**å‹å®šç¾©**:
```typescript
type KeyMap = Record<string, () => void>
```

**å®Ÿè£…ãƒã‚¤ãƒ³ãƒˆ**:
```typescript
export function useKeyboard(keyMap: KeyMap) {
  useEffect(() => {
    const handleKeyDown = (event: KeyboardEvent) => {
      const handler = keyMap[event.key]
      if (handler) {
        event.preventDefault()
        handler()
      }
    }
    
    window.addEventListener('keydown', handleKeyDown)
    
    return () => {
      window.removeEventListener('keydown', handleKeyDown)
    }
  }, [keyMap])
}
```

---

### useLocalStorage

LocalStorageã¨ã®é€£æºã‚’ç®¡ç†ã™ã‚‹Hook

**ãƒ•ã‚¡ã‚¤ãƒ«**: `src/utils/hooks/useLocalStorage.ts`

**è²¬å‹™**:
- LocalStorageã¸ã®ä¿å­˜
- LocalStorageã‹ã‚‰ã®èª­ã¿è¾¼ã¿
- å‹å®‰å…¨ãªæ“ä½œ

**ä½¿ç”¨ä¾‹**:
```typescript
const [saveData, setSaveData] = useLocalStorage<SaveData>('hardboiled-save', defaultSave)
```

**å‹å®šç¾©**:
```typescript
type UseLocalStorageReturn<T> = [
  T,
  (value: T | ((prev: T) => T)) => void,
  () => void
]
```

**å®Ÿè£…ãƒã‚¤ãƒ³ãƒˆ**:
```typescript
export function useLocalStorage<T>(
  key: string,
  initialValue: T
): UseLocalStorageReturn<T> {
  // åˆæœŸå€¤ã®å–å¾—
  const [storedValue, setStoredValue] = useState<T>(() => {
    try {
      const item = window.localStorage.getItem(key)
      return item ? JSON.parse(item) : initialValue
    } catch (error) {
      console.error('Failed to load from localStorage:', error)
      return initialValue
    }
  })
  
  // å€¤ã®æ›´æ–°
  const setValue = useCallback((value: T | ((prev: T) => T)) => {
    try {
      const valueToStore = value instanceof Function ? value(storedValue) : value
      
      setStoredValue(valueToStore)
      window.localStorage.setItem(key, JSON.stringify(valueToStore))
    } catch (error) {
      console.error('Failed to save to localStorage:', error)
    }
  }, [key, storedValue])
  
  // å‰Šé™¤
  const removeValue = useCallback(() => {
    try {
      window.localStorage.removeItem(key)
      setStoredValue(initialValue)
    } catch (error) {
      console.error('Failed to remove from localStorage:', error)
    }
  }, [key, initialValue])
  
  return [storedValue, setValue, removeValue]
}
```

---

### useDebounce

å€¤ã®æ›´æ–°ã‚’é…å»¶ã•ã›ã‚‹Hook

**ãƒ•ã‚¡ã‚¤ãƒ«**: `src/utils/hooks/useDebounce.ts`

**è²¬å‹™**:
- é€£ç¶šã—ãŸå€¤ã®å¤‰æ›´ã‚’é…å»¶
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

**ä½¿ç”¨ä¾‹**:
```typescript
const debouncedSearchTerm = useDebounce(searchTerm, 500)
```

**å®Ÿè£…ãƒã‚¤ãƒ³ãƒˆ**:
```typescript
export function useDebounce<T>(value: T, delay: number): T {
  const [debouncedValue, setDebouncedValue] = useState<T>(value)
  
  useEffect(() => {
    const handler = setTimeout(() => {
      setDebouncedValue(value)
    }, delay)
    
    return () => {
      clearTimeout(handler)
    }
  }, [value, delay])
  
  return debouncedValue
}
```

---

### useInterval

setIntervalã‚’React Hooksã§æ‰±ã„ã‚„ã™ãã™ã‚‹Hook

**ãƒ•ã‚¡ã‚¤ãƒ«**: `src/utils/hooks/useInterval.ts`

**è²¬å‹™**:
- å®šæœŸçš„ãªå‡¦ç†ã®å®Ÿè¡Œ
- ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã®è‡ªå‹•åŒ–

**ä½¿ç”¨ä¾‹**:
```typescript
useInterval(() => {
  // 1ç§’ã”ã¨ã«å®Ÿè¡Œ
  updateTimer()
}, 1000)
```

**å®Ÿè£…ãƒã‚¤ãƒ³ãƒˆ**:
```typescript
export function useInterval(callback: () => void, delay: number | null) {
  const savedCallback = useRef(callback)
  
  // callbackãŒå¤‰æ›´ã•ã‚ŒãŸã‚‰ä¿å­˜
  useEffect(() => {
    savedCallback.current = callback
  }, [callback])
  
  // ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
  useEffect(() => {
    if (delay === null) return
    
    const id = setInterval(() => savedCallback.current(), delay)
    
    return () => clearInterval(id)
  }, [delay])
}
```

---

## ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ä¸€è¦§

### ã‚²ãƒ¼ãƒ ãƒ­ã‚¸ãƒƒã‚¯è£œåŠ©é–¢æ•°

#### getGridSizeForAR
```typescript
/**
 * ARãƒ¬ãƒ™ãƒ«ã‹ã‚‰ã‚°ãƒªãƒƒãƒ‰ã‚µã‚¤ã‚ºã‚’è¨ˆç®—
 * @param arLevel - ARãƒ¬ãƒ™ãƒ«
 * @returns GridSize - ã‚°ãƒªãƒƒãƒ‰ã‚µã‚¤ã‚º
 */
export function getGridSizeForAR(arLevel: number): GridSize {
  const size = 10 + arLevel
  return { width: size, height: size }
}
```

---

#### isUnitDestroyed
```typescript
/**
 * éƒ¨éšŠãŒç ´å£Šã•ã‚ŒãŸã‹åˆ¤å®š
 * @param placedUnit - é…ç½®æ¸ˆã¿éƒ¨éšŠ
 * @returns boolean - ç ´å£Šã•ã‚Œã¦ã„ã‚Œã°true
 */
export function isUnitDestroyed(placedUnit: PlacedUnit): boolean {
  return placedUnit.occupiedCells.length === placedUnit.hitCells.length
}
```

---

#### countRemainingUnits
```typescript
/**
 * æ®‹å­˜éƒ¨éšŠæ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ
 * @param placedUnits - é…ç½®æ¸ˆã¿éƒ¨éšŠãƒªã‚¹ãƒˆ
 * @returns number - æ®‹å­˜éƒ¨éšŠæ•°
 */
export function countRemainingUnits(placedUnits: PlacedUnit[]): number {
  return placedUnits.filter(u => !u.isDestroyed).length
}
```

---

#### getUnexploredCells
```typescript
/**
 * æœªæ¢ç´¢ã®ã‚»ãƒ«ã‚’ã™ã¹ã¦å–å¾—
 * @param field - ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
 * @returns Position[] - æœªæ¢ç´¢ã‚»ãƒ«ã®åº§æ¨™ãƒªã‚¹ãƒˆ
 */
export function getUnexploredCells(field: Field): Position[] {
  const unexplored: Position[] = []
  
  for (let y = 0; y < field.size.height; y++) {
    for (let x = 0; x < field.size.width; x++) {
      if (field.cells[y][x].state === CellState.UNEXPLORED) {
        unexplored.push({ x, y })
      }
    }
  }
  
  return unexplored
}
```

---

### UIè£œåŠ©é–¢æ•°

#### getCellStateColor
```typescript
/**
 * ã‚»ãƒ«çŠ¶æ…‹ã«å¿œã˜ãŸè‰²ã‚’å–å¾—
 * @param state - ã‚»ãƒ«çŠ¶æ…‹
 * @returns string - Tailwindã‚«ãƒ©ãƒ¼ã‚¯ãƒ©ã‚¹
 */
export function getCellStateColor(state: CellState): string {
  switch (state) {
    case CellState.UNEXPLORED:
      return 'bg-gray-700'
    case CellState.HIT:
      return 'bg-red-600'
    case CellState.MISS:
      return 'bg-blue-400'
    case CellState.DESTROYED:
      return 'bg-red-900'
    default:
      return 'bg-gray-700'
  }
}
```

---

#### getStatIcon
```typescript
/**
 * ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸã‚¢ã‚¤ã‚³ãƒ³åã‚’å–å¾—
 * @param stat - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚¿ã‚¤ãƒ—
 * @returns string - ã‚¢ã‚¤ã‚³ãƒ³åï¼ˆlucide-reactï¼‰
 */
export function getStatIcon(stat: StatType): string {
  switch (stat) {
    case StatType.HP:
      return 'Heart'
    case StatType.SP:
      return 'Zap'
    case StatType.AT:
      return 'Sword'
    case StatType.DF:
      return 'Shield'
    case StatType.AR:
      return 'Grid3x3'
    default:
      return 'Circle'
  }
}
```

---

#### getUnitCategoryLabel
```typescript
/**
 * éƒ¨éšŠã‚«ãƒ†ã‚´ãƒªã®æ—¥æœ¬èªãƒ©ãƒ™ãƒ«ã‚’å–å¾—
 * @param category - éƒ¨éšŠã‚«ãƒ†ã‚´ãƒª
 * @returns string - æ—¥æœ¬èªãƒ©ãƒ™ãƒ«
 */
export function getUnitCategoryLabel(category: UnitCategory): string {
  switch (category) {
    case UnitCategory.HEAL:
      return 'å›å¾©ç³»'
    case UnitCategory.ATTACK:
      return 'ç‰¹æ®Šæ”»æ’ƒç³»'
    case UnitCategory.BUFF:
      return 'ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¼·åŒ–ç³»'
    case UnitCategory.SPECIAL:
      return 'è¶…å¼·åŒ–ç³»'
    case UnitCategory.COUNTER:
      return 'ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ç³»'
    default:
      return 'ä¸æ˜'
  }
}
```

---

### ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆé–¢æ•°

#### formatHP
```typescript
/**
 * HPã‚’è¡¨ç¤ºå½¢å¼ã§ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
 * @param current - ç¾åœ¨HP
 * @param max - æœ€å¤§HP
 * @returns string - ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã•ã‚ŒãŸæ–‡å­—åˆ—ï¼ˆä¾‹: "80/100"ï¼‰
 */
export function formatHP(current: number, max: number): string {
  return `${current}/${max}`
}
```

---

#### formatStatValue
```typescript
/**
 * ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å€¤ã‚’è¡¨ç¤ºå½¢å¼ã§ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
 * @param stat - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚¿ã‚¤ãƒ—
 * @param value - å€¤
 * @returns string - ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã•ã‚ŒãŸæ–‡å­—åˆ—
 */
export function formatStatValue(stat: StatType, value: number): string {
  switch (stat) {
    case StatType.HP:
    case StatType.SP:
      return `${value}`
    case StatType.AT:
    case StatType.DF:
      return `${value}`
    case StatType.AR:
      return `Lv.${value}`
    default:
      return `${value}`
  }
}
```

---

#### formatDuration
```typescript
/**
 * ç¶™ç¶šæ™‚é–“ã‚’ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆãƒŸãƒªç§’ â†’ ç§’ï¼‰
 * @param ms - ãƒŸãƒªç§’
 * @returns string - ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã•ã‚ŒãŸæ–‡å­—åˆ—ï¼ˆä¾‹: "10ç§’"ï¼‰
 */
export function formatDuration(ms: number): string {
  const seconds = Math.floor(ms / 1000)
  return `${seconds}ç§’`
}
```

---

## å‹ã‚¬ãƒ¼ãƒ‰é–¢æ•°

### isPosition
```typescript
/**
 * Positionã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ãƒã‚§ãƒƒã‚¯
 * @param obj - ãƒã‚§ãƒƒã‚¯å¯¾è±¡
 * @returns boolean - Positionãªã‚‰true
 */
export function isPosition(obj: any): obj is Position {
  return (
    typeof obj === 'object' &&
    obj !== null &&
    typeof obj.x === 'number' &&
    typeof obj.y === 'number'
  )
}
```

---

### isPlacedUnit
```typescript
/**
 * PlacedUnitã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ãƒã‚§ãƒƒã‚¯
 * @param obj - ãƒã‚§ãƒƒã‚¯å¯¾è±¡
 * @returns boolean - PlacedUnitãªã‚‰true
 */
export function isPlacedUnit(obj: any): obj is PlacedUnit {
  return (
    typeof obj === 'object' &&
    obj !== null &&
    typeof obj.unitId === 'string' &&
    isPosition(obj.position) &&
    typeof obj.rotation === 'number' &&
    Array.isArray(obj.occupiedCells) &&
    Array.isArray(obj.hitCells) &&
    typeof obj.isDestroyed === 'boolean'
  )
}
```

---

## å®šæ•°å®šç¾©

### ã‚²ãƒ¼ãƒ å®šæ•° (game.ts)

```typescript
// ã‚°ãƒªãƒƒãƒ‰ã‚µã‚¤ã‚º
export const MIN_GRID_SIZE = 10
export const MAX_GRID_SIZE = 18

// ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ä¸Šé™
export const MAX_HP_LEVEL = 50
export const MAX_SP_LEVEL = 30
export const MAX_AT_LEVEL = 30
export const MAX_DF_LEVEL = 30
export const MAX_AR_LEVEL = 8

// ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—æ™‚ã®å¢—åŠ é‡
export const LEVEL_UP_INCREASES = {
  [StatType.HP]: 20,
  [StatType.SP]: 10,
  [StatType.AT]: 5,
  [StatType.DF]: 3,
  [StatType.AR]: 1
}

// å›å¾©ã‚³ã‚¹ãƒˆå€ç‡
export const HEAL_COST_MULTIPLIER = 2

// SPå¢—åŠ é‡ï¼ˆã‚¬ãƒ—ãƒªãƒ¼ãƒå°‚ç”¨ã‚¹ã‚­ãƒ«ï¼‰
export const SP_INCREASE_PER_USE = 10

// é€£ç¶šæ”»æ’ƒå¯èƒ½ãªæœ€å¤§å›æ•°
export const MAX_CONSECUTIVE_ATTACKS = 10

// ç„¡å·®åˆ¥æ”»æ’ƒã®ç¶™ç¶šæ™‚é–“ï¼ˆãƒŸãƒªç§’ï¼‰
export const RAPID_FIRE_DURATION = 10000
```

---

### UIå®šæ•° (ui.ts)

```typescript
// ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³æ™‚é–“ï¼ˆãƒŸãƒªç§’ï¼‰
export const ANIMATION_DURATION = {
  SHORT: 200,
  MEDIUM: 500,
  LONG: 1000
}

// ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚µã‚¤ã‚º
export const MODAL_SIZES = {
  sm: 'max-w-sm',
  md: 'max-w-md',
  lg: 'max-w-lg',
  xl: 'max-w-xl'
}

// ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆï¼ˆpxï¼‰
export const BREAKPOINTS = {
  sm: 640,
  md: 768,
  lg: 1024,
  xl: 1280
}

// ã‚°ãƒªãƒƒãƒ‰ã‚»ãƒ«ã‚µã‚¤ã‚ºï¼ˆpxï¼‰
export const CELL_SIZE = {
  mobile: 30,
  tablet: 40,
  desktop: 50
}
```

---

### ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®šæ•° (animation.ts)

```typescript
// Framer Motion variants
export const FADE_IN_VARIANTS = {
  hidden: { opacity: 0 },
  visible: { opacity: 1, transition: { duration: 0.3 } }
}

export const SLIDE_UP_VARIANTS = {
  hidden: { y: 20, opacity: 0 },
  visible: { y: 0, opacity: 1, transition: { duration: 0.4 } }
}

export const SCALE_VARIANTS = {
  hidden: { scale: 0.8, opacity: 0 },
  visible: { scale: 1, opacity: 1, transition: { duration: 0.3 } }
}

// ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š
export const EFFECT_ANIMATIONS = {
  hit: {
    initial: { scale: 0, opacity: 1 },
    animate: { scale: 1.5, opacity: 0 },
    transition: { duration: 0.5 }
  },
  miss: {
    initial: { scale: 1, opacity: 1 },
    animate: { scale: 1.2, opacity: 0 },
    transition: { duration: 0.3 }
  },
  destroy: {
    initial: { scale: 1, opacity: 1 },
    animate: { scale: 0, opacity: 0 },
    transition: { duration: 0.8 }
  }
}
```

---

## ãƒ†ã‚¹ãƒˆãƒ˜ãƒ«ãƒ‘ãƒ¼

### ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ

```typescript
/**
 * ãƒ†ã‚¹ãƒˆç”¨ã®Positionã‚’ç”Ÿæˆ
 */
export function createMockPosition(x = 0, y = 0): Position {
  return { x, y }
}

/**
 * ãƒ†ã‚¹ãƒˆç”¨ã®PlacedUnitã‚’ç”Ÿæˆ
 */
export function createMockPlacedUnit(
  unitId = 'test-unit',
  position: Position = { x: 0, y: 0 }
): PlacedUnit {
  return {
    unitId,
    position,
    rotation: Rotation.DEG_0,
    occupiedCells: [position],
    hitCells: [],
    isDestroyed: false
  }
}

/**
 * ãƒ†ã‚¹ãƒˆç”¨ã®Fieldã‚’ç”Ÿæˆ
 */
export function createMockField(size: GridSize = { width: 10, height: 10 }): Field {
  return {
    size,
    cells: createEmptyGrid(size),
    placedUnits: []
  }
}
```

---

## ä½¿ç”¨ä¸Šã®æ³¨æ„

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è€ƒæ…®äº‹é …

1. **ãƒ¡ãƒ¢åŒ–ã®æ´»ç”¨**
   - é‡ã„è¨ˆç®—ã¯`useMemo`ã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥
   - ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã¯`useCallback`ã§å®‰å®šåŒ–

2. **ä¸è¦ãªå†è¨ˆç®—ã®å›é¿**
   - é…åˆ—æ“ä½œé–¢æ•°ã¯æ–°ã—ã„é…åˆ—ã‚’è¿”ã™ï¼ˆã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ï¼‰
   - ãƒ‡ã‚£ãƒ¼ãƒ—ã‚³ãƒ”ãƒ¼ã¯å¿…è¦æœ€å°é™ã«

3. **å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ã®æ‰±ã„**
   - ã‚°ãƒªãƒƒãƒ‰ãŒå¤§ãã„å ´åˆã¯ä»®æƒ³åŒ–ã‚’æ¤œè¨
   - ä¸€åº¦ã«å‡¦ç†ã™ã‚‹ãƒ‡ãƒ¼ã‚¿é‡ã«æ³¨æ„

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

1. **å¢ƒç•Œå€¤ãƒã‚§ãƒƒã‚¯**
   - åº§æ¨™ãŒã‚°ãƒªãƒƒãƒ‰ç¯„å›²å†…ã‹å¿…ãšç¢ºèª
   - é…åˆ—ã‚¢ã‚¯ã‚»ã‚¹å‰ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å¦¥å½“æ€§ãƒã‚§ãƒƒã‚¯

2. **nullãƒã‚§ãƒƒã‚¯**
   - ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«ãªå€¤ã¯å¿…ãšå­˜åœ¨ç¢ºèª
   - å‹ã‚¬ãƒ¼ãƒ‰é–¢æ•°ã‚’æ´»ç”¨

3. **ä¾‹å¤–å‡¦ç†**
   - æƒ³å®šå¤–ã®å…¥åŠ›ã«å¯¾ã—ã¦é©åˆ‡ãªãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
   - ã‚¨ãƒ©ãƒ¼ã¯ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å‡ºåŠ›

---

**ä»¥ä¸Šã€ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°è¨­è¨ˆæ›¸ï¼ˆç¬¬1ç‰ˆï¼‰**
