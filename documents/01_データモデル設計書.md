# ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«è¨­è¨ˆæ›¸

**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 2.0  
**ä½œæˆæ—¥**: 2025å¹´11æœˆ12æ—¥  
**æ›´æ–°æ—¥**: 2025å¹´11æœˆ13æ—¥  
**å¯¾è±¡ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**: ãƒãƒ¼ãƒ‰ãƒœã‚¤ãƒ«ãƒ‰åˆ‘äº‹é¢¨ã‚²ãƒ¼ãƒ 

---

## ğŸ“‹ ç›®æ¬¡

1. [åŸºæœ¬å‹å®šç¾©](#åŸºæœ¬å‹å®šç¾©)
2. [Enumå®šç¾©](#enumå®šç¾©)
3. [Unitï¼ˆéƒ¨éšŠï¼‰é–¢é€£](#unitéƒ¨éšŠé–¢é€£)
4. [Playerï¼ˆãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ï¼‰é–¢é€£](#playerãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼é–¢é€£)
5. [Enemyï¼ˆæ•µï¼‰é–¢é€£](#enemyæ•µé–¢é€£)
6. [Battleï¼ˆæˆ¦é—˜ï¼‰é–¢é€£](#battleæˆ¦é—˜é–¢é€£)
7. [ã‚»ãƒ¼ãƒ–ãƒ‡ãƒ¼ã‚¿é–¢é€£](#ã‚»ãƒ¼ãƒ–ãƒ‡ãƒ¼ã‚¿é–¢é€£)
8. [ãƒ‡ãƒ¼ã‚¿æ§‹é€ é–¢ä¿‚å›³](#ãƒ‡ãƒ¼ã‚¿æ§‹é€ é–¢ä¿‚å›³)

---

## åŸºæœ¬å‹å®šç¾©

### Positionï¼ˆåº§æ¨™ï¼‰
```typescript
interface Position {
  x: number  // æ¨ªåº§æ¨™ï¼ˆ0å§‹ã¾ã‚Šï¼‰
  y: number  // ç¸¦åº§æ¨™ï¼ˆ0å§‹ã¾ã‚Šï¼‰
}
```

### GridSizeï¼ˆã‚°ãƒªãƒƒãƒ‰ã‚µã‚¤ã‚ºï¼‰
```typescript
interface GridSize {
  width: number   // æ¨ªå¹…ï¼ˆãƒã‚¹æ•°ï¼‰
  height: number  // ç¸¦å¹…ï¼ˆãƒã‚¹æ•°ï¼‰
}
```

### Damageï¼ˆãƒ€ãƒ¡ãƒ¼ã‚¸æƒ…å ±ï¼‰
```typescript
interface Damage {
  amount: number      // ãƒ€ãƒ¡ãƒ¼ã‚¸é‡
  isCritical: boolean // ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ã‹ã©ã†ã‹ï¼ˆå°†æ¥ã®æ‹¡å¼µç”¨ï¼‰
  source: string      // ãƒ€ãƒ¡ãƒ¼ã‚¸ã‚½ãƒ¼ã‚¹ï¼ˆ'direct' | 'special' | 'counter'ï¼‰
}
```

---

## Enumå®šç¾©

### CharacterTypeï¼ˆã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚¿ã‚¤ãƒ—ï¼‰
```typescript
enum CharacterType {
  JACK = 'jack',           // ã‚¸ãƒ£ãƒƒã‚¯åˆ‘äº‹
  GAPRINO = 'gaprino'      // ã‚¬ãƒ—ãƒªãƒ¼ãƒè­¦éƒ¨
}
```

### BattlePhaseï¼ˆæˆ¦é—˜ãƒ•ã‚§ãƒ¼ã‚ºï¼‰
```typescript
enum BattlePhase {
  PLACEMENT = 'placement',  // éƒ¨éšŠé…ç½®ãƒ•ã‚§ãƒ¼ã‚º
  BATTLE = 'battle',        // æˆ¦é—˜ãƒ•ã‚§ãƒ¼ã‚º
  RESULT = 'result'         // çµæœè¡¨ç¤ºãƒ•ã‚§ãƒ¼ã‚º
}
```

### Turnï¼ˆã‚¿ãƒ¼ãƒ³ï¼‰
```typescript
enum Turn {
  PLAYER = 'player',  // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚¿ãƒ¼ãƒ³
  ENEMY = 'enemy'     // æ•µã‚¿ãƒ¼ãƒ³
}
```

### CellStateï¼ˆã‚»ãƒ«ã®çŠ¶æ…‹ï¼‰
```typescript
enum CellState {
  UNEXPLORED = 'unexplored',  // æœªæ”»æ’ƒ
  HIT = 'hit',                // HITï¼ˆéƒ¨éšŠã«å‘½ä¸­ï¼‰
  MISS = 'miss',              // MISSï¼ˆéƒ¨éšŠã«å¤–ã‚Œï¼‰
  DESTROYED = 'destroyed'     // ç ´å£Šæ¸ˆã¿
}
```

### UnitCategoryï¼ˆéƒ¨éšŠã‚«ãƒ†ã‚´ãƒªï¼‰
```typescript
enum UnitCategory {
  HEAL = 'heal',         // å›å¾©ç³»
  ATTACK = 'attack',     // ç‰¹æ®Šæ”»æ’ƒç³»
  BUFF = 'buff',         // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¼·åŒ–ç³»
  SPECIAL = 'special',   // è¶…å¼·åŒ–ç³»
  COUNTER = 'counter'    // ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ç³»ï¼ˆåœ°é›·ï¼‰
}
```

### StatTypeï¼ˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚¿ã‚¤ãƒ—ï¼‰
```typescript
enum StatType {
  HP = 'HP',  // ä½“åŠ›
  SP = 'SP',  // å¿…æ®ºæŠ€ãƒã‚¤ãƒ³ãƒˆ
  AT = 'AT',  // æ”»æ’ƒåŠ›
  DF = 'DF',  // é˜²å¾¡åŠ›
  AR = 'AR'   // ã‚¨ãƒªã‚¢ï¼ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚µã‚¤ã‚ºï¼‰
}
```

### AITypeï¼ˆAIã‚¿ã‚¤ãƒ—ï¼‰
```typescript
enum AIType {
  BALANCED = 'balanced',      // ãƒãƒ©ãƒ³ã‚¹å‹
  AGGRESSIVE = 'aggressive',  // æ”»æ’ƒå‹
  STRATEGIC = 'strategic',    // æˆ¦ç•¥å‹
  EXPERT = 'expert'           // ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆ
}
```

### EnemyIdï¼ˆæ•µIDï¼‰
```typescript
enum EnemyId {
  CARRIER_A = 'carrier_a',      // é‹ã³å±‹A
  MADMAN_B = 'madman_b',        // ç‹‚äººB
  COLONEL_Z = 'colonel_z',      // Zå¤§ä½
  BOMBER_J = 'bomber_j'         // çˆ†å¼¾é­”J
}
```

---

## Unitï¼ˆéƒ¨éšŠï¼‰é–¢é€£

### UnitShapeï¼ˆéƒ¨éšŠã®å½¢çŠ¶ï¼‰
```typescript
// 2æ¬¡å…ƒé…åˆ—ã§å½¢çŠ¶ã‚’è¡¨ç¾
// 1: éƒ¨éšŠãŒå­˜åœ¨ã™ã‚‹ãƒã‚¹, 0: ç©ºç™½ãƒã‚¹
// ä¾‹: æ•‘æ€¥è»Šï¼ˆ2ãƒã‚¹æ¨ªä¸¦ã³ï¼‰ = [[1, 1]]
// ä¾‹: æ•‘æ€¥ãƒ˜ãƒªï¼ˆLå­—å‹ï¼‰ = [[1, 0], [1, 1]]
type UnitShape = number[][]
```

### SpecialAttackPatternï¼ˆç‰¹æ®Šæ”»æ’ƒãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰
```typescript
interface SpecialAttackPattern {
  name: string           // æ”»æ’ƒåï¼ˆ'åå­—çˆ†æ’ƒ', 'ç¸¦åˆ—çˆ†æ’ƒ'ç­‰ï¼‰
  spCost: number         // SPæ¶ˆè²»é‡
  baseSpCost?: number    // åŸºæœ¬SPæ¶ˆè²»é‡ï¼ˆå¢—åŠ ç³»ã®å ´åˆï¼‰
  spIncrease?: number    // SPå¢—åŠ é‡ï¼ˆã‚¬ãƒ—ãƒªãƒ¼ãƒå°‚ç”¨ã®å¢—åŠ ç³»ï¼‰
  type: SpecialAttackType
  // æ”»æ’ƒç¯„å›²ã®è¨ˆç®—æ–¹æ³•ã‚’ç¤ºã™
  // 'cross': åå­—ã€'column': ç¸¦åˆ—ã€'row': æ¨ªåˆ—ã€'auto': è‡ªå‹•æ¤œçŸ¥ã€'steal_turn': ã‚¿ãƒ¼ãƒ³å¥ªå–ã€'rapid': é€£å°„
  attackRange?: AttackRange
  duration?: number      // æŒç¶šæ™‚é–“ï¼ˆç§’ï¼‰- ç„¡å·®åˆ¥æ”»æ’ƒç”¨
}

enum SpecialAttackType {
  CROSS = 'cross',           // åå­—çˆ†æ’ƒ
  COLUMN = 'column',         // ç¸¦åˆ—çˆ†æ’ƒ
  ROW = 'row',               // æ°´å¹³çˆ†æ’ƒ
  BURST = 'burst',           // é›†ä¸­ç ²ç«ï¼ˆ3é€£ç¶šæ”»æ’ƒï¼‰
  RAPID = 'rapid',           // ç„¡å·®åˆ¥æ”»æ’ƒï¼ˆæ™‚é–“åˆ¶é™é€£å°„ï¼‰
  AUTO_DETECT = 'auto_detect', // èª˜å°å¼¾ï¼ˆè‡ªå‹•æ¤œçŸ¥ï¼‰
  STEAL_TURN = 'steal_turn'  // å¦¨å®³å·¥ä½œï¼ˆã‚¿ãƒ¼ãƒ³å¥ªå–ï¼‰
}

interface AttackRange {
  type: 'cross' | 'column' | 'row' | 'point'
  range?: number  // ç¯„å›²ï¼ˆåå­—çˆ†æ’ƒãªã‚‰3ãƒã‚¹ãªã©ï¼‰
}
```

### UnitEffectï¼ˆéƒ¨éšŠåŠ¹æœï¼‰
```typescript
interface UnitEffect {
  type: EffectType
  value: number | string
  target?: 'self' | 'ally' | 'enemy'  // åŠ¹æœå¯¾è±¡
}

enum EffectType {
  // å›å¾©ç³»
  HEAL = 'heal',              // HPå›å¾©ï¼ˆæœ€å¤§HPã®30%ã€1HP=1SPæ¶ˆè²»ï¼‰
  HEAL_LARGE = 'heal_large',  // HPå¤§å›å¾©ï¼ˆæ•‘æ€¥ãƒ˜ãƒªç”¨ã€HEALã¨åŒã˜ä»•æ§˜ï¼‰
  
  // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¼·åŒ–ç³»
  ATK_BOOST = 'atk_boost',    // æ”»æ’ƒåŠ›ã‚¢ãƒƒãƒ—
  DEF_BOOST = 'def_boost',    // é˜²å¾¡åŠ›ã‚¢ãƒƒãƒ—
  EXP_BOOST = 'exp_boost',    // çµŒé¨“å€¤ã‚¢ãƒƒãƒ—
  FIRST_STRIKE = 'first_strike', // å¿…ãšå…ˆåˆ¶æ”»æ’ƒ
  
  // è¶…å¼·åŒ–ç³»
  DOUBLE_BUFF = 'double_buff',        // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹UPåŠ¹æœå€¤ã‚’2å€ã«ï¼ˆå˜ä½“ã§ã¯åŠ¹æœãªã—ï¼‰
  DOUBLE_SPECIAL = 'double_special',  // ç‰¹æ®Šæ”»æ’ƒç¯„å›²ã‚’2å€ã«
  
  // ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ç³»
  COUNTER = 'counter'         // ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼æ”»æ’ƒï¼ˆå›ºå®š1ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼‰
}
```

### Unitï¼ˆéƒ¨éšŠãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ï¼‰
```typescript
interface Unit {
  id: string                 // éƒ¨éšŠIDï¼ˆ'ambulance', 'harrier'ç­‰ï¼‰
  name: string               // è¡¨ç¤ºåï¼ˆ'æ•‘æ€¥è»Š', 'ãƒãƒªã‚¢ãƒ¼'ç­‰ï¼‰
  size: number               // ãƒã‚¹æ•°
  shape: UnitShape           // å½¢çŠ¶ï¼ˆ2æ¬¡å…ƒé…åˆ—ï¼‰
  price: number              // ä¾¡æ ¼
  category: UnitCategory     // ã‚«ãƒ†ã‚´ãƒª
  effect?: UnitEffect        // éƒ¨éšŠåŠ¹æœ
  specialAttack?: SpecialAttackPattern  // ç‰¹æ®Šæ”»æ’ƒ
  maxPlacement: number       // æœ€å¤§é…ç½®æ•°ï¼ˆåœ°é›·ä»¥å¤–ã¯1ã€åœ°é›·ã®ã¿æ‰€æŒæ•°ã¾ã§ï¼‰
  exclusiveFor?: CharacterType  // ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼å°‚ç”¨ï¼ˆundefinedãªã‚‰å…±é€šï¼‰
  description: string        // èª¬æ˜æ–‡
}
```

**è£œè¶³**ï¼š
- åœ°é›·ä»¥å¤–ã®éƒ¨éšŠã¯1å€‹ã¾ã§é…ç½®å¯èƒ½
- åœ°é›·ã¯æ‰€æŒæ•°ã¨åŒã˜æ•°ã¾ã§é…ç½®å¯èƒ½ï¼ˆä¾‹ï¼š3å€‹æ‰€æŒãªã‚‰3å€‹ã¾ã§é…ç½®å¯ï¼‰
- é…ç½®ã§ãã‚‹æ•° = æ‰€æŒã—ã¦ã„ã‚‹æ•°

### PlacedUnitï¼ˆé…ç½®æ¸ˆã¿éƒ¨éšŠï¼‰
```typescript
interface PlacedUnit {
  unitId: string             // éƒ¨éšŠIDï¼ˆUnitã‚’å‚ç…§ï¼‰
  position: Position         // é…ç½®ä½ç½®ï¼ˆå·¦ä¸Šã®åº§æ¨™ï¼‰
  rotation: Rotation         // å›è»¢çŠ¶æ…‹
  occupiedCells: Position[]  // å æœ‰ã—ã¦ã„ã‚‹ã‚»ãƒ«ã®åº§æ¨™ãƒªã‚¹ãƒˆ
  hitCells: Position[]       // è¢«å¼¾ã—ãŸã‚»ãƒ«ã®åº§æ¨™ãƒªã‚¹ãƒˆ
  isDestroyed: boolean       // ç ´å£Šã•ã‚ŒãŸã‹ã©ã†ã‹
}

enum Rotation {
  DEG_0 = 0,      // 0åº¦
  DEG_90 = 90,    // 90åº¦
  DEG_180 = 180,  // 180åº¦
  DEG_270 = 270   // 270åº¦
}
```

---

## Playerï¼ˆãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ï¼‰é–¢é€£

### PlayerStatsï¼ˆãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼‰
```typescript
interface PlayerStats {
  HP: number     // ç¾åœ¨HP
  maxHP: number  // æœ€å¤§HP
  SP: number     // ç¾åœ¨SP
  maxSP: number  // æœ€å¤§SP
  AT: number     // æ”»æ’ƒåŠ›
  DF: number     // é˜²å¾¡åŠ›
  AR: number     // ã‚¨ãƒªã‚¢ãƒ¬ãƒ™ãƒ«ï¼ˆã‚°ãƒªãƒƒãƒ‰ã‚µã‚¤ã‚ºã«å½±éŸ¿ï¼‰
}

interface PlayerMaxStats {
  maxHP: number  // æœ€å¤§HPï¼ˆãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ã§å¢—åŠ ã™ã‚‹åŸºæº–å€¤ï¼‰
  maxSP: number  // æœ€å¤§SPï¼ˆãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ã§å¢—åŠ ã™ã‚‹åŸºæº–å€¤ï¼‰
  maxAR: number  // æœ€å¤§ARãƒ¬ãƒ™ãƒ«ï¼ˆ11ï¼‰
}
```

### PlayerLevelï¼ˆãƒ¬ãƒ™ãƒ«æƒ…å ±ï¼‰
```typescript
interface PlayerLevel {
  [StatType.HP]: number  // HPãƒ¬ãƒ™ãƒ«
  [StatType.SP]: number  // SPãƒ¬ãƒ™ãƒ«
  [StatType.AT]: number  // ATãƒ¬ãƒ™ãƒ«
  [StatType.DF]: number  // DFãƒ¬ãƒ™ãƒ«
  [StatType.AR]: number  // ARãƒ¬ãƒ™ãƒ«
}
```

### Playerï¼ˆãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‡ãƒ¼ã‚¿ï¼‰
```typescript
interface Player {
  character: CharacterType   // é¸æŠã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼
  stats: PlayerStats         // ç¾åœ¨ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
  maxStats: PlayerMaxStats   // æœ€å¤§ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
  levels: PlayerLevel        // å„ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ãƒ¬ãƒ™ãƒ«
  money: number              // æ‰€æŒé‡‘
  exp: number                // çµŒé¨“å€¤
  ownedUnits: string[]       // æ‰€æŒéƒ¨éšŠIDã®é…åˆ—
  placedUnits: PlacedUnit[]  // é…ç½®æ¸ˆã¿éƒ¨éšŠï¼ˆæˆ¦é—˜ä¸­ã®ã¿ä½¿ç”¨ï¼‰
}
```

---

## Enemyï¼ˆæ•µï¼‰é–¢é€£

### EnemyStatsï¼ˆæ•µã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼‰
```typescript
interface EnemyStats {
  HP: number     // ç¾åœ¨HP
  maxHP: number  // æœ€å¤§HP
  SP: number     // ç¾åœ¨SP
  maxSP: number  // æœ€å¤§SP
  AT: number     // æ”»æ’ƒåŠ›
  DF: number     // é˜²å¾¡åŠ›
  AR: number     // ã‚¨ãƒªã‚¢ãƒ¬ãƒ™ãƒ«
}
```

### Enemyï¼ˆæ•µãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ï¼‰
```typescript
interface Enemy {
  id: EnemyId                // æ•µID
  name: string               // è¡¨ç¤ºå
  stats: EnemyStats          // åˆæœŸã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼ˆmaxHP, maxSPå«ã‚€ï¼‰
  units: string[]            // æ‰€æŒéƒ¨éšŠIDã®é…åˆ—
  aiType: AIType             // AIã‚¿ã‚¤ãƒ—
  baseReward: number         // åŸºæœ¬è³é‡‘
  description: string        // èª¬æ˜æ–‡
  difficulty: 'easy' | 'medium' | 'hard' | 'nightmare'  // é›£æ˜“åº¦
}
```

### EnemyStateï¼ˆæ•µã®çŠ¶æ…‹ï¼‰
```typescript
interface EnemyState {
  enemy: Enemy               // æ•µãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿
  currentStats: EnemyStats   // ç¾åœ¨ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
  placedUnits: PlacedUnit[]  // é…ç½®æ¸ˆã¿éƒ¨éšŠ
  lastHitPosition?: Position // æœ€å¾Œã«HITã—ãŸä½ç½®ï¼ˆAIç”¨ï¼‰
  discoveredCells: Position[] // ç™ºè¦‹æ¸ˆã¿ã‚»ãƒ«ï¼ˆAIç”¨ï¼‰
}
```

---

## Battleï¼ˆæˆ¦é—˜ï¼‰é–¢é€£

### Cellï¼ˆã‚°ãƒªãƒƒãƒ‰ã‚»ãƒ«ï¼‰
```typescript
interface Cell {
  position: Position      // ã‚»ãƒ«åº§æ¨™
  state: CellState        // ã‚»ãƒ«ã®çŠ¶æ…‹
  unitId?: string         // é…ç½®ã•ã‚Œã¦ã„ã‚‹éƒ¨éšŠIDï¼ˆã‚ã‚Œã°ï¼‰
  isRevealed: boolean     // å…¬é–‹ã•ã‚Œã¦ã„ã‚‹ã‹ï¼ˆæ•µãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯åŸºæœ¬falseï¼‰
}
```

### Fieldï¼ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼‰
```typescript
interface Field {
  size: GridSize          // ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚µã‚¤ã‚º
  cells: Cell[][]         // 2æ¬¡å…ƒé…åˆ—ã®ã‚»ãƒ«
  placedUnits: PlacedUnit[]  // é…ç½®æ¸ˆã¿éƒ¨éšŠãƒªã‚¹ãƒˆ
}
```

### AttackLogï¼ˆæ”»æ’ƒãƒ­ã‚°ï¼‰
```typescript
interface AttackLog {
  turn: Turn                 // ã©ã¡ã‚‰ã®ã‚¿ãƒ¼ãƒ³ã‹
  position: Position         // æ”»æ’ƒä½ç½®
  result: 'hit' | 'miss'     // çµæœ
  damage?: number            // ãƒ€ãƒ¡ãƒ¼ã‚¸é‡ï¼ˆMISSã®å ´åˆï¼‰
  destroyedUnitId?: string   // ç ´å£Šã—ãŸéƒ¨éšŠIDï¼ˆã‚ã‚Œã°ï¼‰
  isSpecialAttack: boolean   // ç‰¹æ®Šæ”»æ’ƒã‹ã©ã†ã‹
  specialAttackName?: string // ç‰¹æ®Šæ”»æ’ƒå
  timestamp: number          // ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—
}
```

### BattleStateï¼ˆæˆ¦é—˜çŠ¶æ…‹ï¼‰
```typescript
interface BattleState {
  phase: BattlePhase         // ç¾åœ¨ã®ãƒ•ã‚§ãƒ¼ã‚º
  turn: Turn                 // ç¾åœ¨ã®ã‚¿ãƒ¼ãƒ³
  
  // ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
  playerField: Field         // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
  enemyField: Field          // æ•µãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
  
  // æˆ¦é—˜ä¸­ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
  playerStats: PlayerStats   // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ç¾åœ¨ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
  enemyStats: EnemyStats     // æ•µã®ç¾åœ¨ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
  
  // æˆ¦é—˜æƒ…å ±
  enemy: Enemy               // å¯¾æˆ¦ä¸­ã®æ•µ
  attackHistory: AttackLog[] // æ”»æ’ƒå±¥æ­´
  
  // é€£ç¶šæ”»æ’ƒåˆ¶å¾¡
  canContinueAttack: boolean // é€£ç¶šæ”»æ’ƒå¯èƒ½ã‹
  consecutiveHits: number    // é€£ç¶šHITæ•°
  
  // ç‰¹æ®Šæ”»æ’ƒçŠ¶æ…‹
  activeSpecialAttack?: {
    type: SpecialAttackType | null
    startTime?: number       // é–‹å§‹æ™‚åˆ»ï¼ˆç„¡å·®åˆ¥æ”»æ’ƒç”¨ï¼‰
    endTime?: number         // çµ‚äº†æ™‚åˆ»ï¼ˆç„¡å·®åˆ¥æ”»æ’ƒç”¨ï¼‰
    remainingAttacks?: number // æ®‹ã‚Šæ”»æ’ƒå›æ•°ï¼ˆé›†ä¸­ç ²ç«ç”¨ï¼‰
  }
  
  // ç‰¹æ®Šæ”»æ’ƒä½¿ç”¨å›æ•°ï¼ˆã‚¬ãƒ—ãƒªãƒ¼ãƒå°‚ç”¨ã®å¢—åŠ ç³»SPæ¶ˆè²»ç”¨ï¼‰
  specialAttackUsageCount: {
    player: { [unitId: string]: number }  // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®å„éƒ¨éšŠã®ä½¿ç”¨å›æ•°
    enemy: { [unitId: string]: number }   // æ•µã®å„éƒ¨éšŠã®ä½¿ç”¨å›æ•°
  }
}
```

### BattleResultï¼ˆæˆ¦é—˜çµæœï¼‰
```typescript
interface BattleResult {
  isVictory: boolean         // å‹åˆ©ã—ãŸã‹ã©ã†ã‹
  
  // æˆ¦é—˜çµ±è¨ˆ
  totalDamageDealt: number   // ä¸ãˆãŸãƒ€ãƒ¡ãƒ¼ã‚¸
  totalDamageReceived: number // å—ã‘ãŸãƒ€ãƒ¡ãƒ¼ã‚¸
  unitsDestroyed: number     // ç ´å£Šã—ãŸéƒ¨éšŠæ•°
  unitsLost: number          // å¤±ã£ãŸéƒ¨éšŠæ•°
  
  // å ±é…¬è¨ˆç®—
  baseReward: number         // åŸºæœ¬è³é‡‘
  hpBonus: number            // HPæ®‹å­˜ãƒœãƒ¼ãƒŠã‚¹
  unitsBonus: number         // éƒ¨éšŠæ®‹å­˜ãƒœãƒ¼ãƒŠã‚¹
  totalReward: number        // æœ€çµ‚ç²å¾—è³é‡‘
  
  // çµŒé¨“å€¤è¨ˆç®—
  baseExp: number            // åŸºæœ¬çµŒé¨“å€¤
  occupancyBonus: number     // å æœ‰ç‡ãƒœãƒ¼ãƒŠã‚¹
  passengerBonus: boolean    // æ—…å®¢æ©Ÿãƒœãƒ¼ãƒŠã‚¹é©ç”¨
  totalExp: number           // æœ€çµ‚ç²å¾—çµŒé¨“å€¤
  
  // æ®‹å­˜æƒ…å ±
  remainingHP: number        // æ®‹å­˜HP
  remainingUnits: number     // æ®‹å­˜éƒ¨éšŠæ•°
}
```

---

## ã‚»ãƒ¼ãƒ–ãƒ‡ãƒ¼ã‚¿é–¢é€£

### GameProgressï¼ˆã‚²ãƒ¼ãƒ é€²è¡ŒçŠ¶æ³ï¼‰
```typescript
interface GameProgress {
  defeatedEnemies: EnemyId[]  // å€’ã—ãŸæ•µã®IDãƒªã‚¹ãƒˆ
  currentEnemy?: EnemyId      // ç¾åœ¨å¯¾æˆ¦ä¸­ã®æ•µï¼ˆnull = æ•µé¸æŠç”»é¢ï¼‰
  totalBattles: number        // ç·æˆ¦é—˜å›æ•°
  totalVictories: number      // ç·å‹åˆ©å›æ•°
  totalDefeats: number        // ç·æ•—åŒ—å›æ•°
}
```

### SaveDataï¼ˆã‚»ãƒ¼ãƒ–ãƒ‡ãƒ¼ã‚¿ï¼‰
```typescript
interface SaveData {
  version: string            // ã‚»ãƒ¼ãƒ–ãƒ‡ãƒ¼ã‚¿ãƒãƒ¼ã‚¸ãƒ§ãƒ³
  lastSaved: string          // æœ€çµ‚ä¿å­˜æ—¥æ™‚ï¼ˆISOå½¢å¼ï¼‰
  
  player: {
    character: CharacterType
    stats: PlayerStats
    maxStats: PlayerMaxStats
    levels: PlayerLevel
    money: number
    exp: number
    ownedUnits: string[]
  }
  
  progress: GameProgress
  
  // ã‚ªãƒ—ã‚·ãƒ§ãƒ³è¨­å®šï¼ˆå°†æ¥ã®æ‹¡å¼µç”¨ï¼‰
  settings?: {
    soundVolume: number
    musicVolume: number
  }
}
```

---

## ãƒ‡ãƒ¼ã‚¿æ§‹é€ é–¢ä¿‚å›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SaveData                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Player                                              â”‚ â”‚
â”‚  â”‚  - character: CharacterType                        â”‚ â”‚
â”‚  â”‚  - stats: PlayerStats                              â”‚ â”‚
â”‚  â”‚  - levels: PlayerLevel                             â”‚ â”‚
â”‚  â”‚  - ownedUnits: string[] â”€â”€â”€â”€â”                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                 â”‚                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ GameProgress                                        â”‚ â”‚
â”‚  â”‚  - defeatedEnemies: EnemyId[]                       â”‚ â”‚
â”‚  â”‚  - currentEnemy: EnemyId â”€â”€â”€â”€â”                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚   Enemy (Master Data)   â”‚
                     â”‚  - id: EnemyId          â”‚
                     â”‚  - stats: EnemyStats    â”‚
                     â”‚  - units: string[] â”€â”€â”  â”‚
                     â”‚  - aiType: AIType    â”‚  â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”˜
                                            â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BattleState    â”‚                           â”‚ Unit (Master)    â”‚
â”‚                â”‚                           â”‚  - id: string    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                           â”‚  - shape: [][]   â”‚
â”‚  â”‚  Field   â”‚  â”‚                           â”‚  - effect        â”‚
â”‚  â”‚          â”‚  â”‚                           â”‚  - specialAttack â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â” â”‚  â”‚                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  â”‚ â”‚ Cell â”‚ â”‚  â”‚                                    â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚                                    â”‚
â”‚  â”‚          â”‚  â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”´â”€â”€â”          â”‚
â”‚  â”‚ â”‚ PlacedUnit   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  â”‚ â”‚  - unitId    â”‚
â”‚  â”‚ â”‚  - position  â”‚
â”‚  â”‚ â”‚  - rotation  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”
â”‚  â”‚  AttackLog      â”‚
â”‚  â”‚  - position     â”‚
â”‚  â”‚  - result       â”‚
â”‚  â”‚  - damage       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### é–¢ä¿‚æ€§ã®èª¬æ˜

1. **SaveData â†’ Player**
   - ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®æ°¸ç¶šåŒ–ãƒ‡ãƒ¼ã‚¿
   - ownedUnitsã§Unitï¼ˆãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ï¼‰ã‚’å‚ç…§

2. **SaveData â†’ GameProgress**
   - ã‚²ãƒ¼ãƒ é€²è¡ŒçŠ¶æ³ã‚’ä¿æŒ
   - currentEnemyã§Enemyï¼ˆãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ï¼‰ã‚’å‚ç…§

3. **BattleState â†’ Field â†’ Cell**
   - ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯è¤‡æ•°ã®ã‚»ãƒ«ã§æ§‹æˆ
   - ã‚»ãƒ«ã¯éƒ¨éšŠé…ç½®æƒ…å ±ã‚’æŒã¤

4. **BattleState â†’ PlacedUnit â†’ Unit**
   - é…ç½®æ¸ˆã¿éƒ¨éšŠã¯unitIdã§Unitãƒã‚¹ã‚¿ãƒ¼ã‚’å‚ç…§
   - é…ç½®ä½ç½®ã€å›è»¢çŠ¶æ…‹ã€è¢«å¼¾çŠ¶æ³ã‚’ä¿æŒ

5. **Enemy â†’ Unit**
   - æ•µãŒæ‰€æŒã™ã‚‹éƒ¨éšŠã‚’unitsã§å‚ç…§

---

## è£œè¶³äº‹é …

### å‹ã®ä½¿ã„åˆ†ã‘

- **interface**: ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æ§‹é€ ã‚’å®šç¾©ï¼ˆPlayer, Unit, BattleStateãªã©ï¼‰
- **enum**: å›ºå®šã®é¸æŠè‚¢ã‚’å®šç¾©ï¼ˆTurn, BattlePhase, AITypeãªã©ï¼‰
- **type**: ç‰¹æ®Šãªå‹ã‚„ãƒ¦ãƒ‹ã‚ªãƒ³å‹ï¼ˆUnitShape, AttackRangeãªã©ï¼‰

### æ‹¡å¼µæ€§ã®è€ƒæ…®

ä»¥ä¸‹ã®é …ç›®ã¯å°†æ¥ã®æ‹¡å¼µã‚’è¦‹è¶Šã—ã¦è¨­è¨ˆï¼š
- `description`: å„ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã«èª¬æ˜æ–‡ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
- `settings`: ã‚»ãƒ¼ãƒ–ãƒ‡ãƒ¼ã‚¿ã«ã‚ªãƒ—ã‚·ãƒ§ãƒ³è¨­å®šæ 
- `target`: UnitEffectã«åŠ¹æœå¯¾è±¡ã‚’æŒ‡å®š
- `exclusiveFor`: Unitã«ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼å°‚ç”¨ãƒ•ãƒ©ã‚°

### å‘½åè¦å‰‡

- **interfaceå**: ãƒ‘ã‚¹ã‚«ãƒ«ã‚±ãƒ¼ã‚¹ï¼ˆPlayerStats, BattleStateï¼‰
- **enumå**: ãƒ‘ã‚¹ã‚«ãƒ«ã‚±ãƒ¼ã‚¹ï¼ˆBattlePhase, Turnï¼‰
- **enumå€¤**: ã‚¹ãƒãƒ¼ã‚¯ã‚±ãƒ¼ã‚¹å¤§æ–‡å­—ï¼ˆUNEXPLORED, FIRST_STRIKEï¼‰
- **ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å**: ã‚­ãƒ£ãƒ¡ãƒ«ã‚±ãƒ¼ã‚¹ï¼ˆcurrentHP, isDestroyedï¼‰

---

## è¨­è¨ˆæ±ºå®šäº‹é …

æœ¬è¨­è¨ˆæ›¸ã¯ä»¥ä¸‹ã®ä»•æ§˜ç¢ºèªã«åŸºã¥ã„ã¦ä½œæˆã•ã‚Œã¦ã„ã¾ã™ï¼š

### 1. å›å¾©ç³»éƒ¨éšŠã®ä»•æ§˜
- **å›å¾©é‡**: æœ€å¤§HPã®30%
- **SPæ¶ˆè²»**: 1HP = 1SPï¼ˆ30HPå›å¾©ãªã‚‰30SPæ¶ˆè²»ï¼‰
- **ä½¿ç”¨æ¡ä»¶**: 30HPå›å¾©ã§ããªã„å ´åˆã¯ä½¿ç”¨ä¸å¯
- **ä½¿ç”¨å›æ•°**: æˆ¦é—˜ä¸­ä½•åº¦ã§ã‚‚ä½¿ç”¨å¯èƒ½

### 2. åœ°é›·ã®ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼æ”»æ’ƒ
- **ãƒ€ãƒ¡ãƒ¼ã‚¸**: å›ºå®š1ãƒ€ãƒ¡ãƒ¼ã‚¸
- **ç™ºå‹•æ¡ä»¶**: åœ°é›·ã‚’è¸ã‚“ã ã‚‰å¿…ãšç™ºå‹•
- **ç™ºå‹•ã‚¿ã‚¤ãƒŸãƒ³ã‚°**: ã‚¹ã‚­ãƒ«æ”»æ’ƒã®å ´åˆã¯ã‚¹ã‚­ãƒ«æ”»æ’ƒçµ‚äº†å¾Œ
- **è¤‡æ•°åœ°é›·**: åŒæ™‚ã«è¤‡æ•°è¸ã‚“ã å ´åˆã€è¸ã‚“ã æ•°ã ã‘ãƒ©ãƒ³ãƒ€ãƒ ã«ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼

### 3. ç‰¹æ®Šæ”»æ’ƒã®SPå¢—åŠ 
- **ä¿æŒå ´æ‰€**: `BattleState.specialAttackUsageCount`
- **ãƒªã‚»ãƒƒãƒˆ**: æˆ¦é—˜ã”ã¨ã«ãƒªã‚»ãƒƒãƒˆ
- **å¯¾è±¡**: ã‚¬ãƒ—ãƒªãƒ¼ãƒå°‚ç”¨ã®ã€Œèª˜å°å¼¾ã€ã¨ã€Œå¦¨å®³å·¥ä½œã€

### 4. å·¨å¤§é£›è¡Œè‰‡ã®åŠ¹æœ
- **åŠ¹æœ**: ä»–ã®ãƒãƒ•ç³»éƒ¨éšŠã®åŠ¹æœå€¤ã‚’2å€ã«ï¼ˆ30%â†’60%ï¼‰
- **æ¡ä»¶**: å·¨å¤§é£›è¡Œè‰‡ + ãƒãƒ•ç³»éƒ¨éšŠã®ä¸¡æ–¹ãŒå¿…è¦
- **å˜ä½“**: åŠ¹æœãªã—

### 5. èˆªç©ºæ¯è‰¦ã®åŠ¹æœ
- **åŠ¹æœ**: ç‰¹æ®Šæ”»æ’ƒã®ç¯„å›²ã‚’2å€ã«æ‹¡å¤§
- **å®Ÿè£…**: æ”»æ’ƒç¯„å›²ã‚’2å€ï¼ˆ2å›æ”»æ’ƒã§ã¯ãªã„ï¼‰

### 6. é›†ä¸­ç ²ç«ã®ç™ºå‹•æ¡ä»¶
- **ç™ºå‹•**: é¸ã‚“ã ãƒã‚¹ã«æ•µè‰¦ãŒãªã„å ´åˆã®ã¿3å›æ”»æ’ƒ
- **HITæ™‚**: æ•µè‰¦ãŒã‚ã‚‹å ´åˆã¯é€šå¸¸é€šã‚ŠHITã—ã¦ã‚¿ãƒ¼ãƒ³çµ‚äº†

### 7. ARãƒ¬ãƒ™ãƒ«ã®æœ€å¤§å€¤
- **æœ€å¤§**: 11ï¼ˆ12Ã—12ã‚°ãƒªãƒƒãƒ‰ã€144ãƒã‚¹ï¼‰

### 8. éƒ¨éšŠã®æ‰€æŒã¨é…ç½®
- **åŸå‰‡**: é…ç½®å¯èƒ½æ•° = æ‰€æŒæ•°
- **ä¾‹**: åœ°é›·ã‚’3ã¤æ‰€æŒ â†’ æœ€å¤§3ã¤ã¾ã§é…ç½®å¯èƒ½

---

**ä»¥ä¸Šã€ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«è¨­è¨ˆæ›¸ï¼ˆç¬¬2ç‰ˆï¼‰**